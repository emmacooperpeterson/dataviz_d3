<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <script type="text/javascript" src="./d3/d3.min.js"></script>
  <title>First d3 Graph</title>
</head>

<body>

  <div class="container">
    <div id="chart"></div>
  </div>


  <script>

  var margin = {top: 100, right: 75, bottom: 125, left: 50};
  var width = 800 - margin.left - margin.right;
  var height = 400 - margin.top - margin.bottom;



  d3.json("count_by_type.json", function(error, data) {
    if (error) throw error;

    dataset = data;

    dataset.forEach(function (d) {
      d.type = d.type
      d.count = +d.count;
    });

    makeBarchart();

  });



  function makeBarchart() {
    console.log(dataset);

    var xScale = d3.scaleBand()
      .domain(dataset.map(function(d) {return d.type;}))
      .range([0,width]);

    var yScale = d3.scaleLinear()
      .domain([0, d3.max(dataset, function(d) {return d.count;})])
      .range([height, 0])

    svg = d3.select("#chart")
      .append('svg')
      .attr("width", width + margin.left + margin.right)
      .attr("height", height + margin.top + margin.bottom);

    svg.append('g')
      .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
      .call(d3.axisBottom(xScale));

    svg.append('g')
      .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
      .call(d3.axisLeft(yScale));

    var g = svg.append('g')
          .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

    g.selectAll(".bar")
      .data(dataset)
      .enter()
      .append("rect")
      .attr("class", "bar")
      .attr("x", function(d) {return xScale(d.type);})
      .attr("y", function (d) {return yScale(d.count);})
      .attr("width", function(d) {return xScale.bandwidth();})
      .attr("height", function(d) {return yScale(d.count);})

    };





  </script>


</body>
</html>
